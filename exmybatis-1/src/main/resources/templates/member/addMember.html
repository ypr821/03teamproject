<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layout/default}">
	
	
	<th:block layout:fragment="customTitle">
		<title th:text="${title}"></title>
	</th:block>
	<th:block layout:fragment="customJs">
		<script>
			$(function(){
				$('#idCheck').click(function(){
					//console.log('í´ë¦­ì´ë²¤íŠ¸ í™•ì¸');
					var memberId = $("[name = memberId ]").val();
					console.log(memberId);
					
					$.ajax({
						url: "/idCheck",
						type: "POST",
						dataType: "json",
						data: {memberId:memberId},

						success: function(data){
							if(data){
								alert('ì‚¬ìš©ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.');
								$('[name = memberId ]').attr('disabled',"disabled")
								
								$('#addMemberForm input').prop('disabled',false);
								$('#addMemberForm select').prop('disabled',false);
								$('#addMemberForm button').prop('disabled',false);
							}else if(data == false){
								
								alert('ì¤‘ë³µì•„ì´ë””ì…ë‹ˆë‹¤ ë‹¤ë¥¸ì•„ì´ë””ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”');
								$('[name = memberId ]').focus();
							}
							
							console.log(data);
						},
						error: function (request, status, error){
							console.log(error);
						}
					});
				});
				
				$('#addMemberBtn').click(function(){
					console.log('addMemberBtn í´ë¦­ì´ë²¤íŠ¸ ì‹¤í–‰');
					
					var regexPw = /^.*(?=^.{2,8}$)(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&+=]).*$/;
					var regexEmail= /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
					var submitFlag = true;
					var inputObj = $('#addMemberForm').find('input'); 
					//console.log(inputObj);
					$.each(inputObj,function(e){

						var inputName = $(this).attr('name');
						var inputValue = $(this).val();
						var inputLabel = $(this).parents('tr').children().eq(0).text().trim();
						//console.log('inputLabel:'+ inputLabel);
						
						if(inputName == 'memberPw'){
							if( !regexPw.test(inputValue)){
								console.log(!regexPw.test(inputValue));
								alert(inputLabel +'ì„ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”. ë¹„ë°€ë²ˆí˜¸ ì¡°ê±´ì€ ìµœì†Œ2ìì—ì„œ ìµœëŒ€8ì íŠ¹ìˆ˜ë¬¸ì 1ê°œì´ìƒ í¬í•¨ ì˜ì–´ ëŒ€ë¬¸ì 1ê°œì´ìƒ í¬í•¨í•´ì£¼ì„¸ìš” ');
								$(this).focus();
								submitFlag = false;
								return submitFlag;
							}
						}else if(inputName == 'memberEmail'){
							if(!regexEmail.test(inputValue)){
								alert(inputLabel + ' ì„ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
								$(this).focus();
								submitFlag = false;
								return submitFlag;
							}
						}else{
							if(inputValue == '' || inputValue == undefined || inputValue == null){
								alert(inputLabel + ' ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
								$(this).focus();
								submitFlag = false;
								return submitFlag;
							}
						}
					});
					
					if(submitFlag) memberForm.submit();
				});
			});
		
		
		</script>
	</th:block>
		
	
	</th:block>
	
	<th:block layout:fragment="customContents">
		ğŸ™ŒğŸ™Œ íšŒì›ê°€ì… í™”ë©´ì…ë‹ˆë‹¤ ğŸ™ŒğŸ™Œ
		
			<form th:action="@{/addMember}" method="post" id="addMemberForm">
				<table border="1">
					<tr>
						<td>
							ì•„ì´ë””
						</td>
						<td>
							<input type="text" name="memberId" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" >
						</td>
						<td>
							<button type="button" id="idCheck">ì¤‘ë³µì²´í¬</button>
						</td>
					</tr>
					<tr>
						<td>
							ë¹„ë²ˆ
						</td>
						<td>
							<input type="text" name="memberPw" placeholder="ë¹„ë²ˆ ì…ë ¥í•´ì£¼ì„¸ìš”" disabled="disabled">
						</td>
					</tr>	
					<tr>
						<td>
							ì´ë¦„
						</td>
						<td>
							<input type="text" name="memberName" placeholder="ì´ë¦„ ì…ë ¥í•´ì£¼ì„¸ìš”" disabled="disabled">
						</td>
					</tr>
					<tr>
						<td>
							ê¶Œí•œ
						</td>
						<td>
							<select name="memberLevel"  disabled="disabled">
								<option value="1">ê´€ë¦¬ì</option>
								<option value="2">íŒë§¤ì</option>
								<option value="3">êµ¬ë§¤ì</option>
							</select>
						</td>
					</tr>
						
					<tr>	
						<td>
							ì´ë©”ì¼
						</td>
						<td>
							<input type="text" name="memberEmail" placeholder="ì´ë©”ì¼ ì…ë ¥í•´ì£¼ì„¸ìš”" disabled="disabled">
						</td>
					</tr>
					<tr>
						<td>
							ì£¼ì†Œ
						</td>
						<td>
							<input type="text" name="memberAddr" placeholder="ì£¼ì†Œì…ë ¥í•´ì£¼ì„¸ìš”" disabled="disabled">
						</td>
					</tr>
					
				</table>
				<button id="addMemberBtn" type="button" disabled="disabled">íšŒì›ê°€ì…</button>
			</form>
		
	</th:block>
	
	
	
</html>